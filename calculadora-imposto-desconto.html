<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Desconto do IR!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .money-positive {
            color: #059669;
        }
        .money-negative {
            color: #dc2626;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
                <i class="fas fa-calculator text-yellow-400 mr-3"></i>
                Calculadora IR - Desconto nova lei
            </h1>
            <p class="text-xl text-white/90 max-w-2xl mx-auto">
                Simule o desconto no Imposto de Renda com o PL 1087/25.
            </p>
        </div>

        <!-- Calculator Card -->
        <div class="max-w-2xl mx-auto">
            <div class="bg-white rounded-2xl card-shadow p-8">
                <!-- Input Section -->
                <div class="mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">
                        <i class="fas fa-money-bill-wave mr-2"></i>
                        Salário Bruto
                    </h2>
                    
                    <div class="relative">
                        <label for="salary" class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-dollar-sign mr-1"></i>Valor do Salário
                        </label>
                        <div class="relative">
                            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-semibold">R$</span>
                            <input 
                                type="number" 
                                id="salary" 
                                min="0" 
                                step="0.01"
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-lg"
                                placeholder="0,00"
                            >
                        </div>
                    </div>
                </div>

                <!-- Calculate Button -->
                <button 
                    id="calculateBtn"
                    class="w-full bg-gradient-to-r from-green-500 to-blue-600 text-white font-semibold py-4 px-6 rounded-lg hover:from-green-600 hover:to-blue-700 transform hover:scale-105 transition-all duration-200 mb-6"
                >
                    <i class="fas fa-calculator mr-2"></i>
                    Calcular
                </button>

                <!-- Results Section -->
                <div id="results" class="hidden space-y-4">
                    <!-- Current IR -->
                    <div class="bg-red-50 rounded-xl p-6 border border-red-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>
                            IR Atual (Sem Desconto)
                        </h3>
                        <div class="text-center">
                            <div id="currentIR" class="text-3xl font-bold money-negative mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Valor que você paga hoje
                            </div>
                        </div>
                    </div>

                    <!-- New IR -->
                    <div class="bg-green-50 rounded-xl p-6 border border-green-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-check-circle text-green-600 mr-2"></i>
                            IR com Nova Lei
                        </h3>
                        <div class="text-center">
                            <div id="newIR" class="text-3xl font-bold money-positive mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Valor após a nova lei
                            </div>
                        </div>
                    </div>

                    <!-- Previous Net Salary -->
                    <div class="bg-orange-50 rounded-xl p-6 border border-orange-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-wallet text-orange-600 mr-2"></i>
                            Salário Líquido Atual
                        </h3>
                        <div class="text-center">
                            <div id="previousNetSalary" class="text-3xl font-bold text-orange-600 mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Seu salário líquido atual (lei vigente)
                            </div>
                        </div>
                    </div>

                    <!-- New Net Salary -->
                    <div class="bg-emerald-50 rounded-xl p-6 border border-emerald-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-wallet text-emerald-600 mr-2"></i>
                            Salário Líquido com Nova Lei
                        </h3>
                        <div class="text-center">
                            <div id="netSalary" class="text-3xl font-bold text-emerald-600 mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Seu salário líquido após os descontos de INSS e novos valores de IR
                            </div>
                        </div>
                    </div>

                    <!-- Savings -->
                    <div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-piggy-bank text-blue-600 mr-2"></i>
                            Economia Mensal
                        </h3>
                        <div class="text-center">
                            <div id="savings" class="text-3xl font-bold text-blue-600 mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Quanto você vai economizar por mês
                            </div>
                        </div>
                    </div>

                    <!-- Annual Savings -->
                    <div class="bg-purple-50 rounded-xl p-6 border border-purple-200">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
                            <i class="fas fa-calendar-alt text-purple-600 mr-2"></i>
                            Economia Anual
                        </h3>
                        <div class="text-center">
                            <div id="annualSavings" class="text-3xl font-bold text-purple-600 mb-2">
                                R$ 0,00
                            </div>
                            <div class="text-sm text-gray-600">
                                Economia total em 12 meses (Considerando o 13º salário)
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Info Section -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Como funcionará a nova lei?
                    </h4>
                    <div class="text-sm text-blue-700 space-y-2">
                        <p>A lei não prevê a criação de novas faixas ou atualização da tabela do IR, e sim um 
                            mecanismo de desconto que será aplicado de forma progressiva.  
                            O desconto será total para salários até R$ 5.000, 
                            e decrescente linearmente para salários acima de R$ 5.000 e abaixo de R$ 7.350.
                        </p>
                        <p><strong>Até R$ 5.000:</strong> Desconto de até R$ 312,89 (imposto zero)</p>
                        <p><strong>R$ 5.000 a R$ 7.350:</strong> Desconto decrescente linearmente</p>
                        <p><strong>Acima de R$ 7.350:</strong> Sem desconto</p>
                        <p><strong>Fórmula do desconto:</strong><br><pre class="whitespace-pre-wrap wrap-break-word text-justify">R$978,62 * (0,133145 - Salário bruto)</pre></p>
                        <!-- Pro dev que tá lendo isso aqui: Semana que vem eu faço um gráfico pra mostrar o decréscimo valeu -->
                    </div>
                    <p class="text-sm text-blue-700">Fonte: <a href="https://www.camara.leg.br/proposicoesWeb/fichadetramitacao?idProposicao=2487436" target="_blank">PL 1087/25</a></p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8">
            <p class="text-white/70 text-sm">
                <i class="fas fa-balance-scale mr-1"></i>
                Simulação baseada no <a href="https://www.camara.leg.br/proposicoesWeb/fichadetramitacao?idProposicao=2487436" target="_blank">PL 1087/25, disponível no site da Câmara</a>.
            </p>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const salaryInput = document.getElementById("salary");
            const calculateBtn = document.getElementById("calculateBtn");
            const resultsDiv = document.getElementById("results");
            const currentIRDiv = document.getElementById("currentIR");
            const newIRDiv = document.getElementById("newIR");
            const savingsDiv = document.getElementById("savings");
            const annualSavingsDiv = document.getElementById("annualSavings");
            const previousNetSalaryDiv = document.getElementById("previousNetSalary");
            const netSalaryDiv = document.getElementById("netSalary");

            const salarioMinimoAtual = 1518;
            const descontoSimplificado = (salarioMinimoAtual * 2) * 0.20;

            // Tabela de IR atual (2025)
            const irTable = [
                { min: 0, max: 2428.80, rate: 0, deduction: 0 },
                { min: 2428.81, max: 2826.65, rate: 0.075, deduction: 182.16 },
                { min: 2826.66, max: 3751.05, rate: 0.15, deduction: 394.16 },
                { min: 3751.06, max: 4664.68, rate: 0.225, deduction: 675.49 },
                { min: 4664.69, max: Infinity, rate: 0.275, deduction: 908.73 },
            ];

            // Tabela de INSS atual (2025)
            const inssTable = [
                { min: 0, max: 1518, rate: 0.075, deduction: 0 },
                { min: 1518.01, max: 2793.88, rate: 0.09, deduction: 22.77 },
                { min: 2793.89, max: 4190.83, rate: 0.12, deduction: 106.59 },
                { min: 4190.84, max: 8157.41, rate: 0.14, deduction: 190.40 },
            ];

            function calculateINSS(salary) {
                for (let bracket of inssTable) {
                    if (salary >= bracket.min && salary <= bracket.max) {
                        return Math.max(0, ((salary * bracket.rate) - bracket.deduction));
                    }
                }
                return 0;
            }

            function calculateCurrentIR(salary) {
                const inss = calculateINSS(salary);
                console.log("INSS: ", inss);
                const discount = Math.max(descontoSimplificado, inss);
                console.log("Desconto: ", discount);
                const salaryAfterDiscount = Math.max(0, salary - discount);

                for (let bracket of irTable) {
                    if (salaryAfterDiscount >= bracket.min && salaryAfterDiscount <= bracket.max) {
                        return Math.max(0, ((salaryAfterDiscount * bracket.rate) - bracket.deduction));
                    }
                }
                return 0;
            }

            function calculateNewIRDiscount(salary, currentIR) {
                if (salary <= 5000) {
                    return Math.min(312.89, currentIR);
                } else if (salary <= 7350) {
                    const discount = 978.62 - (0.133145 * salary);
                    return Math.max(0, discount);
                } else {
                    return 0;
                }
            }

            function formatCurrency(value) {
                return new Intl.NumberFormat("pt-BR", {
                    style: "currency",
                    currency: "BRL"
                }).format(value);
            }

            function calculateIR() {
                const salary = parseFloat(salaryInput.value) || 0;
                
                if (salary <= 0) {
                    resultsDiv.classList.add("hidden");
                    return;
                }

                const currentIR = calculateCurrentIR(salary);
                const inss = calculateINSS(salary);

                const discount = calculateNewIRDiscount(salary, currentIR);
                const newIR = Math.max(0, currentIR - discount);
                const savings = currentIR - newIR;
                const annualSavings = savings * 13; // Considera o 13º salário
                
                const previousNetSalary = salary - inss - currentIR;
                
                const netSalary = salary - inss - newIR;

                currentIRDiv.textContent = formatCurrency(currentIR);
                newIRDiv.textContent = formatCurrency(newIR);
                savingsDiv.textContent = formatCurrency(savings);
                annualSavingsDiv.textContent = formatCurrency(annualSavings);
                previousNetSalaryDiv.textContent = formatCurrency(previousNetSalary);
                netSalaryDiv.textContent = formatCurrency(netSalary);

                resultsDiv.classList.remove("hidden");
            }
            calculateBtn.addEventListener("click", calculateIR);
            salaryInput.addEventListener("input", calculateIR);

            salaryInput.addEventListener("blur", function() {
                const value = parseFloat(this.value) || 0;
                this.value = value.toFixed(2);
            });
        });
    </script>
</body>
</html>
